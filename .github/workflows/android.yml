name: Android CI

on: [pull_request, push]

env:
   AWS_ACCESS_KEY: ${{secrets.AWS_ACCESS_KEY}}
   AWS_SECRET_ACCESS_KEY: ${{secrets.AWS_SECRET_ACCESS_KEY}}
  

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3
    - name: set up JDK 11
      uses: actions/setup-java@v3
      with:
        java-version: '11'
        distribution: 'temurin'
        cache: gradle

    - name: Grant execute permission for gradlew
      run: chmod +x gradlew
    - name: Build with Gradle
      run: ./gradlew clean build

  deviceFarmTest:
              needs: [build]
              runs-on: ubuntu-latest
              
              steps:
                - uses: actions/checkout@v3
                - name: set up JDK 11
                  uses: actions/setup-java@v3
                  with:
                    java-version: '11'
                    distribution: 'temurin'
                    cache: gradle

                - name: Grant execute permission for gradlew
                  run: chmod +x gradlew
                - name: Test on devicefarm
                  run: ./gradlew devicefarmUpload







